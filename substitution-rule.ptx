<section xml:id="section-substitution-rule">
  <title>Substitution Rule Review</title>
  <p>
    Since doing integrals is doing derivatives backwards, we might try
    to start reversing all the differentiation rules. Linearity works
    exactly the same in reverse. We inverted the power rule in the
    previous list of examples. Inverting the product rule starts to
    become strange, but we will cover than in the next section on
    integration by parts.  Arguably the most important differentiation
    rule is the chain rule. We will try to reverse it here.
  </p>
  <definition>
    <statement>
      <p>
        If we have <m>f(g(x))</m>, then <m>\frac{d}{dx} f(g(x)) =
        f^\prime(g(x)) g^\prime(x)</m>. Therefore, we can simply
        reverse the identity to get:
        <me>
          \int f^\prime(g(x)) g^\prime(x) = f(g(x)) + c
        </me>
      </p>
      <p>
        This is called the substitution rule.
      </p>
    </statement>
  </definition>
  <p>
    When we covered the chain rule in Calculu I, I recommended
    labelling the inside function with a new variable <m>u = g(x)</m>.
    That becomes even more important here. It's easiest to explain the
    process by example.
  </p>
  <example>
    <statement>
      <me>
        \int 2x (x^2+1)^4 dx
      </me>
      <p>
        This integral involves a composition. Label the inside
        function <m>u = x^2 + 1</m>. Then we change the entire
        integral from the variable <m>x</m> to the varaibles <m>u</m>.
        This is a substitution, hence the rule is called the
        substitution rule. We also need to change the differential
        term <m>dx</m>. This term is strange and confusing, and we
        really don't have the room and energy to go into all the
        historical subtleties of differentials. If <m>u = u(x)</m> is
        the relationthip between <m>u</m> and <m>x</m>, then <m>du =
        u^\prime(x) dx</m> is the relationship between <m>dx</m> and
        <m>du</m>. Here <m>u = x^2 +1</m>, so <m>du = (2x) dx</m>.
        Let's rewrite the original integral.
        <me>
          \int (x^2+1)^4 (2x)dx
        </me>
      </p>
      <p>
        We can see that substitution works well here: we can replace
        <m>x^2 +1</m> with <m>u</m> and <m>(2x) dx</m> with
        <m>du</m>.
        <me>
          \int u^4 du
        </me>
      </p>
      <p>
        We can find the anti-derivative easily by reversing the power
        rule.
        <me>
          \int u^4 du = \frac{u^5}{5} + c
        </me>
      </p>
      <p>
        Then we undo the substitution, by replacing <m>u</m> with
        <m>x^2+4</m>.
        <me>
          \int 2x (x^2+1)^4 dx = \int u^4 du = \frac{u^5}{5} + c =
          \frac{(x^2+4)^5}{5} + c
        </me>
      </p>
    </statement>
  </example>
  <example>
    <statement>
      <md>
        <mrow>
          \int xe^{x^2} dx \amp u=x^2  du = 2xdx
          </mrow>
        <mrow>
          \int e^u \frac{du}{2} \amp = \frac{e^u}{2} + c =
          \frac{e^{x^2}}{2} + C
        </mrow>
        <mrow>
          \int \frac{x}{x-2} dx \amp u = x-2  du = dx
        </mrow>
        <mrow>
          \int \frac{u+2}{u} du \amp = \int 1 + \frac{2}{u} du
        </mrow>
        <mrow>
          \amp = u + 2 \ln |u| + c = x - 2 + 2\ln|x-2| + c
        </mrow>
        <mrow>
          \int \frac{1}{10x-3} dx \amp u = 10x-3  du = 10dx
        </mrow>
        <mrow>
          \int \frac{1}{u} \frac{du}{10} \amp = \frac{\ln |u|}{10} +
          c = \frac{ \ln| 10x -3 |}{10}
        </mrow>
      </md>
    </statement>
  </example>
  <p>
    When we do substitution with definite integrals, we also need to
    change the bounds. If <m>a</m> and <m>b</m> are the bounds in
    <m>x</m> and <m>u = u(x)</m> is the relationship between <m>u</m>
    and <m>x</m>, then <m>u(a)</m> and <m>u(b)</m> will be the bounds
    in <m>u</m>. One nice thing about definite integrals is that we
    can use these new bounds to evaluate the integral. We don't have
    to substitute back after we finish.
  </p>
  <example>
    <statement>
      <md>
        <mrow>
          \int_0^2 \frac{2x}{(x^2+1)^2} dx \amp u x^2+1  du = 2xdx
          u(0) = 1  u(2) = 5
        </mrow>
        <mrow>
          \int_1^5 \frac{du}{u^2} \amp = \left. -\frac{1}{u}
          \right|_2^5 = 1 - \frac{1}{5} = \frac{4}{5}
        </mrow>
        <mrow>
          \int_{-1}^2 x^2 e^{x^3+1} dx \amp u = x^3+1  du = 3x^2dx
          u(-1) = 0  u(2) = 9
        </mrow>
        <mrow>
          \int_0^9 e^u \frac{du}{3} \amp = \left. \frac{e^u}{3}
          \right|_0^9 = \frac{e^9}{3} - \frac{1}{3} = \frac{e^9-1}{3}
        </mrow>
        <mrow>
          \int_0^{\pi/4} \frac{\sin x}{\cos^3 x} dx \amp u = \cos x
          du = -\sin x dx  u(0) = 1  u(\pi/4) = \frac{\sqrt{2}}{2}
        </mrow>
        <mrow>
          \int_1^{\frac{\sqrt{2}}{2}} \frac{-du}{u^3} \amp = \left.
          \frac{2}{u^2} \right|_1^{\frac{\sqrt{2}}{2}} = 4-2 = 2
        </mrow>
      </md>
    </statement>
  </example>
</section>
